#!/usr/bin/env python3

"""
Vulnerability Scanner - Backward Compatibility Module

This module maintains backward compatibility by re-exporting functions
from the new modular structure.
"""

# Import all functions from the new modular structure
from scanners.single_scanner import (
    scan_vulnerabilities,
    scan_single_ip_vulnerabilities,
    scan_single_ip_vulnerabilities_no_save
)

from scanners.batch_scanner import scan_multiple_ips_with_session

from core.nmap_client import get_nmap
from core.vulnerability_parser import parse_vulnerability_result

# Re-export for backward compatibility
__all__ = [
    'scan_vulnerabilities',
    'scan_single_ip_vulnerabilities', 
    'scan_single_ip_vulnerabilities_no_save',
    'scan_multiple_ips_with_session',
    'get_nmap',
    'parse_vulnerability_result'
]

# Legacy functions for backward compatibility
def get_nmap():
    """Legacy function - use core.nmap_client.get_nmap() instead"""
    from core.nmap_client import get_nmap as _get_nmap
    return _get_nmap()

def parse_vulnerability_result(script_name, script_output):
    """Legacy function - use core.vulnerability_parser.parse_vulnerability_result() instead"""
    from core.vulnerability_parser import parse_vulnerability_result as _parse_vuln
    return _parse_vuln(script_name, script_output) 